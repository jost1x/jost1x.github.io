---
import * as Icons from "@lucide/astro";
import { getCollection } from "astro:content";

const skills = await getCollection("skills", ({ data }) => !data.hidden);

const getSizeClasses = (count: number) => {
  if (count >= 10) return "md:col-span-2 md:row-span-2 p-5";
  if (count >= 7) return "md:row-span-2 p-5";
  if (count >= 4) return "md:col-span-2 p-5";
  return "p-4";
};
---

<section id="about" class="py-24 px-6">
  <div class="max-w-5xl mx-auto">
    <p class="text-primary text-xs tracking-[0.2em] uppercase mb-4">Sobre mí</p>

    <p class="text-muted-foreground text-base leading-relaxed mb-10 max-w-2xl">
      Profesional con experiencia en diseño, desarrollo y despliegue de sistemas
      IoT. Apasionado por la tecnología y comprometido con el desarrollo de
      soluciones disruptivas que transforman la interacción con el mundo
      conectado.
    </p>

    <div
      class="grid
        grid-cols-1
        sm:grid-cols-2
        md:grid-cols-4
        auto-rows-fr
        gap-4
        grid-flow-dense"
    >
      {
        skills.map((skill) => {
          const Icon =
            skill.data.icon && Icons[skill.data.icon]
              ? Icons[skill.data.icon]
              : Icons.HelpCircle;

          return (
            <div
              class={`
                rounded-xl
                border border-white/6 bg-white/3 backdrop-blur-md transition-all duration-300 hover:border-primary/20 hover:bg-white/6
                flex flex-col gap-2
                ${getSizeClasses(skill.data.keywords.length)}
              `}
            >
              <h3 class="text-foreground font-medium text-md leading-tight flex gap-2 items-center">
                <div class="p-2 w-fit rounded-md bg-primary/10 text-primary">
                  <Icon size={16} stroke-width={1.75} />
                </div>
                <span>{skill.data.name}</span>
              </h3>

              <ul class="flex flex-wrap gap-2">
                {skill.data.keywords.map((k) => (
                  <li class="px-2 text-xs rounded-md bg-white/4 text-white/70 border border-white/6">
                    {k}
                  </li>
                ))}
              </ul>
            </div>
          );
        })
      }
    </div>
  </div>
</section>
